Washington —AS someone who has spent most of the past 25 years of his professional life in the United States government, think tanks and academia trying to stop the North Korean nuclear weapons program, I found last week’s nuclear test and the events that followed depressingly familiar. They reminded me of Captain Renault’s famous line from “Casablanca” just before he shuts down Rick’s Café: “I’m shocked, shocked to find that gambling is going on in here!” The reactions to North Korea’s 2006, 2009 and 2013 nuclear tests were the same — shock. Yet a decade has gone by and the North Korean nuclear threat has only grown.

I probably shouldn’t say this, but I take my hat off to the North Koreans. They have played their cards extremely well. Despite this episodic outrage, they have managed to become a full-fledged small nuclear power with a growing and increasingly sophisticated arsenal. Moreover, even as they have moved down the nuclear path, they have maintained fairly normal political, economic and other relations with many countries from China to Ethiopia. In effect, a large number of countries have tacitly accepted North Korea as a nuclear weapons state.

How has the North been able to do this? There are, of course, wonky answers: Unilateral and multilateral sanctions haven’t been forceful enough, negotiators haven’t been tough enough. But a big reason you will not often hear is that Americans and the international community have a comic book image of North Korea. We simply don’t take them seriously.

Their people are robots, sporting lapel-pin pictures of their Dear Leader and regularly attending mass rallies where thousands move in unison like the Radio City Rockettes. Their official media — hyperbolic pronouncements, constant threats and worshipful praise of the leader — magnifies a cultlike image. And most of all, their leaders look strange to us — for example, Kim Jong-il with his funny hairdo and dark glasses. Senator Ted Cruz typified this perception of the North recently, labeling the current leader, Kim Jong-un, as a “crazy nutcase” with a nuclear bomb.

I have been meeting with North Korean government officials for more than two decades in their country, Europe and Asia, and I can tell you that they are neither nutcases nor comic book characters. They are a diverse group, from hidebound apparatchiks to bureaucrats who teach themselves English by listening to foreign radio broadcasts. Some of them, military men especially, are hard-line, patriotic and, above all, anti-American.

I found that out firsthand in the 1990s, while leading a team on an inspection of a military-run underground facility that we thought might violate the 1994 United States-North Korea denuclearization agreement. My team was locked in a room surrounded by soldiers with bayonets drawn after one member of our team violated the inspection procedures. Many of us thought we were going to be killed. Eventually, we managed to extricate ourselves, but as we left the base in an old school bus, the military men followed us in a truck with a loudspeaker blaring anti-American slogans. I asked our North Korean civilian escort if they were going to follow us for the whole ride back to our hotel — two hours over bumpy roads. He responded with a smile: “Do you want them to?”

Americans might find it surprising that many North Korean officials take a nonideological view of foreign affairs. Indeed, we would call them realists. They are well aware of their national interests and are dedicated to safeguarding them, a dedication that is based on a keen understanding of the outside world. A case in point: At one meeting, I was sitting next to a well-connected North Korean official who wanted to talk about Hillary Clinton’s book “It Takes a Village.” (I was embarrassed to say I had not read it.) The North Koreans have demonstrated to me during many meetings that they are well versed in the particulars of political, economic and other developments in China, South Korea and Japan.

It shouldn’t be surprising that North Koreans are realists. For decades, Americans thought Mao Zedong was an irrational, unstable dictator. But when the chips were down, he also turned out to be a serious realist by opening better relations with President Richard M. Nixon and Henry A. Kissinger after his relationship with Moscow deteriorated. In fact, I have been present several times when North Korean officials have met privately with Mr. Kissinger. They seemed to view those sessions as unprecedented opportunities to learn at the feet of an American statesman whom they deeply respect and admire.

Don’t get me wrong. The North Koreans may know a lot about the outside world, but they don’t know everything, even about the United States, their main adversary. In one meeting, an official asked, “Why do the president and secretary of state keep saying that the United States will not allow North Korea to have nuclear weapons when in fact you are not doing much to stop us?” He deduced that there must be a hidden agenda. “It’s because you want us to have nuclear weapons as an excuse to tighten your grip on South Korea and Japan, your two allies.” We responded that there was no hidden agenda and that the United States really did not want the North to have those weapons. I’m not sure we convinced him.

What does all of this mean for America’s future policy toward North Korea? Immediate, strong responses to provocations are fine. So are public statements of indignation; bigger and better sanctions; more pressure on the North’s Chinese allies to support these measures; military steps to show the North Koreans and our allies that we are resolute. These are all warranted. But the North Koreans are in this for the long haul. They feel that their country and its government’s survival is at stake. Unless Americans take them seriously and formulate a long-term strategy for stopping this threat, rather than adopting ad hoc tactical responses, when North Korea conducts its fifth nuclear test a few years from now, the United States will find itself, like Captain Renault in “Casablanca,” rounding up the usual suspects.